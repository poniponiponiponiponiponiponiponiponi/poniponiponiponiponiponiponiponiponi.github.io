<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Archiving My Write-Ups From Our Old, Now Removed, Wiki | poni’s blog</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Archiving My Write-Ups From Our Old, Now Removed, Wiki" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction With the decision to nuke our team’s old wiki where we sometimes put our write-ups I decided to archive my writings so it doesn’t get lost in the void. Why we decided to remove it? Most of us put our write-ups on our blogs anyway and the wiki was glowing with emptiness. Why I didn’t put them on my blog like I did with some other ones? Probably out of laziness, but I also didn’t want to spam this blog with one or two short write-ups per ctf." />
<meta property="og:description" content="Introduction With the decision to nuke our team’s old wiki where we sometimes put our write-ups I decided to archive my writings so it doesn’t get lost in the void. Why we decided to remove it? Most of us put our write-ups on our blogs anyway and the wiki was glowing with emptiness. Why I didn’t put them on my blog like I did with some other ones? Probably out of laziness, but I also didn’t want to spam this blog with one or two short write-ups per ctf." />
<link rel="canonical" href="https://poniponiponiponiponiponiponiponiponi.github.io/ctf/rev/emulator/pyjail/2024/01/05/Archiving-old-writeups.html" />
<meta property="og:url" content="https://poniponiponiponiponiponiponiponiponi.github.io/ctf/rev/emulator/pyjail/2024/01/05/Archiving-old-writeups.html" />
<meta property="og:site_name" content="poni’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Archiving My Write-Ups From Our Old, Now Removed, Wiki" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-01-05T00:00:00+00:00","datePublished":"2024-01-05T00:00:00+00:00","description":"Introduction With the decision to nuke our team’s old wiki where we sometimes put our write-ups I decided to archive my writings so it doesn’t get lost in the void. Why we decided to remove it? Most of us put our write-ups on our blogs anyway and the wiki was glowing with emptiness. Why I didn’t put them on my blog like I did with some other ones? Probably out of laziness, but I also didn’t want to spam this blog with one or two short write-ups per ctf.","headline":"Archiving My Write-Ups From Our Old, Now Removed, Wiki","mainEntityOfPage":{"@type":"WebPage","@id":"https://poniponiponiponiponiponiponiponiponi.github.io/ctf/rev/emulator/pyjail/2024/01/05/Archiving-old-writeups.html"},"url":"https://poniponiponiponiponiponiponiponiponi.github.io/ctf/rev/emulator/pyjail/2024/01/05/Archiving-old-writeups.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://poniponiponiponiponiponiponiponiponi.github.io/feed.xml" title="poni&apos;s blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">poni&#39;s blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/about/software">Software I use and why</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Archiving My Write-Ups From Our Old, Now Removed, Wiki</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-01-05T00:00:00+00:00" itemprop="datePublished">Jan 5, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="introduction">Introduction</h1>
<p>With the decision to nuke our team’s old wiki where we sometimes put our write-ups I decided to archive my writings so it doesn’t get lost in the void. Why we decided to remove it? Most of us put our write-ups on our blogs anyway and the wiki was glowing with emptiness. Why I didn’t put them on my blog like I did with some other ones? Probably out of laziness, but I also didn’t want to spam this blog with one or two short write-ups per ctf.</p>

<h1 id="amateursctf-2023">amateursCTF 2023</h1>
<h2 id="---writeup">🏴❓🇨🇹🇫 - writeup</h2>
<p>This was a write-up written for a write-up competition post ctf where 5 writeups were given $50. The idea was very simple - because the challenge was about emojicode, let’s make write it with a lot of emojis too. I was able to get $50 so hey, free money!</p>

<h3 id="introduction-">Introduction 🌟</h3>
<p>🔍🔓🔬 For this exciting reverse engineering challenge, we present to you a mind-boggling 🚩 checker! 🕵️‍♂️🔍👀 Get ready to dive into the extraordinary world of an esoteric language known as emojicode 🎩💫✨. Brace yourself, as we unveil the mysterious source code below: 📝💻👇</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>🏁 🍇
    👄🔤▶️🔤❗️🆕🔡▶️👂🏼❗️➡️input

    🆕🔠256❗️➡️ChessBattleAdvanced
    🔂griddle 📇input❗️🍇 
        🐻ChessBattleAdvanced 🔡🔢griddle❗️2❗️❗️
    🍉
    📇🔡ChessBattleAdvanced❗️❗️➡️ac7u411y.1t5.th3.inpu7.4ga1n
    ↪️📏ac7u411y.1t5.th3.inpu7.4ga1n❓▶256🍇
        😀🔤❌❌🔤❗️🚪🐇💻1❗️
    🍉

    🆕🍨🐚🔢🍆❗️➡️🖍️🆕hint
    🆕🍨hint 16❗️➡️🖍️🆕egg
    🆕🍨hint 16❗️➡️🖍️🆕bacon

    🔂i🆕⏩0 📏ac7u411y.1t5.th3.inpu7.4ga1n❓❗️🍇
        ↪️ 🔢🐽ac7u411y.1t5.th3.inpu7.4ga1n i❗️❗️➖48🙌1🍇
            🐽egg i🚮16 ❗️➡️🖍️hint
            ↪️📏hint❓ 🙌 0🍇🐻hint 0❗️🍉
            🐽hint 📏hint❓➖1 ❗️➕1➡️🐽hint 📏hint❓➖1❗️hint➡️🐽egg i🚮16❗️

            🐽bacon i➗16 ❗️➡️🖍️hint
            ↪️📏hint❓ 🙌 0🍇🐻hint 0❗️🍉
            🐽hint 📏hint❓➖1 ❗️➕1➡️🐽hint 📏hint❓➖1❗️hint➡️🐽bacon i➗16❗️
        🍉
        🙅 🍇
            🐽egg i🚮16 ❗️➡️🖍️hint
            ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️▶0🍇🐻hint 0❗️🍉
            hint➡️🐽egg i🚮16 ❗️

            🐽bacon i➗16 ❗️➡️🖍️hint
            ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️▶0🍇🐻hint 0❗️🍉
            hint➡️🐽bacon i➗16 ❗️
        🍉
    🍉
    🔂i🆕⏩0 16❗️🍇
        🐽egg i❗️➡️🖍️hint
        ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️🙌0🍇🐼hint❗️🍉
        hint➡️🐽egg i❗️

        🐽bacon i❗️➡️🖍️hint
        ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️🙌0🍇🐼hint❗️🍉
        hint➡️🐽bacon i❗️
    🍉

    🍿🍿1 1 1 2 1🍆🍿1 2 10🍆🍿2 3 2 1 2🍆🍿4 3 1 1🍆🍿2 4 4🍆🍿2 1 5 1🍆🍿2 2 1 3 2🍆🍿4 6 1 1🍆🍿1 1 2 1 2 2🍆🍿2 2 5 1🍆🍿1 1 3 5 1🍆🍿1 1 2 2 1 3🍆🍿2 1 2 3🍆🍿2 5 7🍆🍿1 2 6 1🍆🍿1 3 1 3 3🍆🍆 ➡️ chicken
    🍿🍿2 3 2 3🍆🍿4 1 2🍆🍿1 4 1 4 1🍆🍿3 3 3🍆🍿1 1 1 2 3🍆🍿1 4 5 1🍆🍿2 1 4 3🍆🍿7 1 2🍆🍿1 3 2 2 2🍆🍿4 3 2 3🍆🍿3 3 7🍆🍿1 3 3 3🍆🍿4 3 1🍆🍿2 1 2 7🍆🍿2 3 1 3 1🍆🍿3 7 1🍆🍆 ➡️ pig

    0➡️🖍️🆕the-tale-of-farmer-john-and-his-cow-bessie
    🔂i 🆕⏩0 16❗️🍇
        ↪️🐽chicken i❗️ 🙌 🐽egg i❗️🍇
            the-tale-of-farmer-john-and-his-cow-bessie ⬅️➕ 1
        🍉

        ↪️🐽pig i❗️ 🙌 🐽bacon i❗️🍇
            the-tale-of-farmer-john-and-his-cow-bessie ⬅️➕ 1
        🍉
    🍉
    💭 here's a freebie for you
    💭 😀🔡the-tale-of-farmer-john-and-his-cow-bessie❗️❗️

    ↪️🤜the-tale-of-farmer-john-and-his-cow-bessie 🙌 32🤛🍇😀🔤✅🔤❗️🍉
    🙅🍇😀🔤❌❌🔤❗️🍉
🍉
</code></pre></div></div>

<h3 id="failed-attempts-">Failed attempts 🔨🔥</h3>
<p>😩 As the normal solving method seemed incredibly painful (I must admit, working with esolangs can be quite frustrating), I embarked on a quest to find a smarter way to conquer this challenge. 🤔💡</p>
<h4 id="searching-for-side-channel-attacks-️️">Searching for side-channel attacks 🔍🕵️‍♂️</h4>
<p>🔢 Sometimes, in challenges where the flag is checked letter by letter, we can unleash the power of a simple side-channel attack. ⌛🔍🔢 By carefully observing execution time or counting executed instructions, we can determine the elusive flag. 🏴‍☠️🔍🔐 In fact, I successfully employed this technique in another CTF challenge called jvm – a delightful VM written in Java. 🎉🔍✍️ To crack it, I injected instruction counting into the bytecode, enabling me to swiftly snatch the flag. 💪🔓</p>

<p>🔧 For regular executables, this approach becomes a tad more challenging. Nonetheless, I’ve previously created a modest tool for such purposes, though nothing too fancy. It harnesses the power of perf command’s instruction counting, albeit lacking absolute precision. 🛠️💻 If you’re curious, you can find the tool here: https://github.com/tabun-dareka/side-channel-crackme-solver. 🌟🔬✨ For further exploration on this fascinating subject, I highly recommend Julien Voisin’s article “Crackme Solving for the Lazies” from the esteemed magazine “Paged Out! #1”. 📚📰
<img src="/files/image.png" alt="image.png" />
📷👀 As depicted in the screenshot, my attempts were in vain. Surprisingly, it yielded the same outcome each time. 🤷‍♀️🖼️</p>

<h4 id="decompiling">Decompiling</h4>
<p>🛠️ The compiler works its magic and conjures a binary. Perhaps it’s readable enough? 🤔</p>

<p>🔢📦 The resulting binary manifests as a colossal function, boasting tens of thousands of instructions. Alas, Ghidra succumbs to freezing when attempting to decompile it. 😱❄️</p>

<p>🙅‍♀️ Yeah… NOPE! 🙅‍♂️</p>

<p>💡 I also embarked on a valiant endeavor to perform basic memory analysis with gdb, diligently setting watchpoints. However, I swiftly abandoned this idea in the face of its complexity. ⏳🔬💻</p>

<h4 id="chatgpt-to-the-rescue-">ChatGPT to the rescue? 💫💻</h4>
<p>🌙🌠 Oh, one would think so. However, it regrettably spewed out nonsensical gibberish. Perhaps it’s a skill issue, but truth be told, despite being hailed as the ultimate tool by many, it never quite worked its magic for me. Instead, it consistently churned out garbage and misleading information. 🚫🤷‍♂️🗑️</p>

<h3 id="the-actual-solution-">The actual solution 🔐✨</h3>
<p>😔 Sigh… it’s time to embark on an adventure to learn emojicode. I won’t delve into the intricate details of the process, but essentially, what I did was meticulously explore each and every emoji in the language documentation found at https://www.emojicode.org/docs/ to decipher its meaning. 📚💻🔍 While it may be a humorous language, it surprisingly boasts a multitude of features, which ironically made it more challenging to comprehend due to the lack of comprehensive documentation. 😅📖 The absence of examples proved to be the most agonizing aspect for me. However, with a little assistance from my teammate, sn0w, I successfully translated the program to sneklang. 🐍🐍 And now… BEHOLD. 🙌🐍</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">our_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="n">bits</span> <span class="o">=</span> <span class="s">""</span>
<span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">our_input</span><span class="p">,</span> <span class="s">'ascii'</span><span class="p">):</span>
    <span class="n">bits</span> <span class="o">+=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">byte</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>


<span class="n">egg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bacon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">egg</span><span class="p">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="n">bacon</span><span class="p">.</span><span class="n">append</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bits</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="s">"1"</span><span class="p">:</span>
        <span class="c1"># 🐽egg i🚮16 ❗️➡️🖍️hint
</span>        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
        <span class="c1"># ↪️📏hint❓ 🙌 0🍇🐻hint 0❗️🍉
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># 🐽hint 📏hint❓➖1 ❗️➕1➡️🐽hint 📏hint❓➖1❗️hint➡️🐽egg i🚮16❗️
</span>        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="c1"># 🐽bacon i➗16 ❗️➡️🖍️hint
</span>        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span>
        <span class="c1"># ↪️📏hint❓ 🙌 0🍇🐻hint 0❗️🍉
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># 🐽hint 📏hint❓➖1 ❗️➕1➡️🐽hint 📏hint❓➖1❗️hint➡️🐽bacon i➗16❗️
</span>        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># 🐽egg i🚮16 ❗️➡️🖍️hint
</span>        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
        <span class="c1"># ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️▶0🍇🐻hint 0❗️🍉
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># hint➡️🐽egg i🚮16 ❗️
</span>        <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="c1"># 🐽bacon i➗16 ❗️➡️🖍️hint
</span>        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span>
        <span class="c1"># ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️▶0🍇🐻hint 0❗️🍉
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># hint➡️🐽bacon i➗16 ❗️
</span>        <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="c1"># 🐽egg i❗️➡️🖍️hint
</span>    <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️🙌0🍇🐼hint❗️🍉
</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hint</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="c1"># hint➡️🐽egg i❗️
</span>    <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

    <span class="c1"># 🐽bacon i❗️➡️🖍️hint
</span>    <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># ↪️📏hint❓▶0 🤝 🐽hint 📏hint❓➖1❗️🙌0🍇🐼hint❗️🍉
</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hint</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="c1"># hint➡️🐽bacon i❗️
</span>    <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

<span class="c1"># 🍿🍿1 1 1 2 1🍆🍿1 2 10🍆🍿2 3 2 1 2🍆🍿4 3 1 1🍆🍿2 4 4🍆🍿2 1 5 1🍆🍿2 2 1 3 2🍆🍿4 6 1 1🍆🍿1 1 2 1 2 2🍆🍿2 2 5 1🍆🍿1 1 3 5 1🍆🍿1 1 2 2 1 3🍆🍿2 1 2 3🍆🍿2 5 7🍆🍿1 2 6 1🍆🍿1 3 1 3 3🍆🍆 ➡️ chicken
</span><span class="n">c</span> <span class="o">=</span> <span class="s">"1 1 1 2 1🍆🍿1 2 10🍆🍿2 3 2 1 2🍆🍿4 3 1 1🍆🍿2 4 4🍆🍿2 1 5 1🍆🍿2 2 1 3 2🍆🍿4 6 1 1🍆🍿1 1 2 1 2 2🍆🍿2 2 5 1🍆🍿1 1 3 5 1🍆🍿1 1 2 2 1 3🍆🍿2 1 2 3🍆🍿2 5 7🍆🍿1 2 6 1🍆🍿1 3 1 3 3"</span>
<span class="n">chicken</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">c</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"🍆🍿"</span><span class="p">):</span>
    <span class="n">chicken</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">()])</span>
<span class="c1"># 🍿🍿2 3 2 3🍆🍿4 1 2🍆🍿1 4 1 4 1🍆🍿3 3 3🍆🍿1 1 1 2 3🍆🍿1 4 5 1🍆🍿2 1 4 3🍆🍿7 1 2🍆🍿1 3 2 2 2🍆🍿4 3 2 3🍆🍿3 3 7🍆🍿1 3 3 3🍆🍿4 3 1🍆🍿2 1 2 7🍆🍿2 3 1 3 1🍆🍿3 7 1🍆🍆 ➡️ pig
</span><span class="n">c</span> <span class="o">=</span> <span class="s">"2 3 2 3🍆🍿4 1 2🍆🍿1 4 1 4 1🍆🍿3 3 3🍆🍿1 1 1 2 3🍆🍿1 4 5 1🍆🍿2 1 4 3🍆🍿7 1 2🍆🍿1 3 2 2 2🍆🍿4 3 2 3🍆🍿3 3 7🍆🍿1 3 3 3🍆🍿4 3 1🍆🍿2 1 2 7🍆🍿2 3 1 3 1🍆🍿3 7 1"</span>
<span class="n">pig</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">c</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"🍆🍿"</span><span class="p">):</span>
    <span class="n">pig</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">()])</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">chicken</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">pig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"CORRECT"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"INCORRECT"</span><span class="p">)</span>
</code></pre></div></div>
<p>💬🔢 I’ve added comments to provide clarity on which line corresponds to which code in the emojicode. 📝👀 Essentially, the program operates based on input’s bits and performs additions on the values of the arrays, which are treated as stacks. 🔄🔢 It’s worth noting that the stack nature of the arrays becomes crucial in solving the challenge, as we can deduce that the program won’t access elements that appear earlier since there are no popping operations involved. 💡</p>

<p>To determine if the given input can lead to success, a “trivial” check is performed. As for the solution, a backtracking algorithm is implemented. 🔄🔍 Backtracking is a computer sciency way of saying: try one approach ➡️ check if it’s possible to complete ➡️ if not, backtrack and try another approach. 🔄🔎 It’s possible that I may have gone a bit overboard with the backtracking, but I attempted to print the values and perform the process manually. Unfortunately, my brain proved too small for the task. 😅🧠</p>

<p>🔎🔢 One important observation to make is that instead of directly working with characters, my program searches for the specific bits that need to be inserted. 🕵️‍♀️💡 Then, once these bits are found, we will transform them back into their corresponding characters. 🔄🔡</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">c</span> <span class="o">=</span> <span class="s">"1 1 1 2 1🍆🍿1 2 10🍆🍿2 3 2 1 2🍆🍿4 3 1 1🍆🍿2 4 4🍆🍿2 1 5 1🍆🍿2 2 1 3 2🍆🍿4 6 1 1🍆🍿1 1 2 1 2 2🍆🍿2 2 5 1🍆🍿1 1 3 5 1🍆🍿1 1 2 2 1 3🍆🍿2 1 2 3🍆🍿2 5 7🍆🍿1 2 6 1🍆🍿1 3 1 3 3"</span>
<span class="n">chicken</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">c</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"🍆🍿"</span><span class="p">):</span>
    <span class="n">chicken</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">c</span> <span class="o">=</span> <span class="s">"2 3 2 3🍆🍿4 1 2🍆🍿1 4 1 4 1🍆🍿3 3 3🍆🍿1 1 1 2 3🍆🍿1 4 5 1🍆🍿2 1 4 3🍆🍿7 1 2🍆🍿1 3 2 2 2🍆🍿4 3 2 3🍆🍿3 3 7🍆🍿1 3 3 3🍆🍿4 3 1🍆🍿2 1 2 7🍆🍿2 3 1 3 1🍆🍿3 7 1"</span>
<span class="n">pig</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">c</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"🍆🍿"</span><span class="p">):</span>
    <span class="n">pig</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">egg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">bacon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">egg</span><span class="p">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="n">bacon</span><span class="p">.</span><span class="n">append</span><span class="p">([])</span>


<span class="k">def</span> <span class="nf">check_status</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

    <span class="n">egg_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">egg</span><span class="p">)</span>
    <span class="n">bacon_copy</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">bacon</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">egg_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">bacon_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>


    <span class="k">for</span> <span class="n">chicken_line</span><span class="p">,</span> <span class="n">egg_line</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chicken</span><span class="p">,</span> <span class="n">egg_copy</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chicken_line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">egg_line</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">egg_element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">egg_line</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">egg_element</span> <span class="o">&lt;</span> <span class="n">chicken_line</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">egg_line</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">egg_element</span> <span class="o">&gt;</span> <span class="n">chicken_line</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">pig_line</span><span class="p">,</span> <span class="n">bacon_line</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pig</span><span class="p">,</span> <span class="n">bacon_copy</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pig_line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">bacon_line</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bacon_element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bacon_line</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bacon_element</span> <span class="o">&lt;</span> <span class="n">pig_line</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bacon_line</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">bacon_element</span> <span class="o">&gt;</span> <span class="n">pig_line</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bacon_copy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pig</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">chicken</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">egg_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">pig</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">bacon_copy</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'pleading'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"CORRECT"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">True</span>


<span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">bit</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">chicken</span>
    <span class="k">global</span> <span class="n">pig</span>
    <span class="k">global</span> <span class="n">egg</span>
    <span class="k">global</span> <span class="n">bacon</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="c1"># Small optimization
</span>    <span class="k">if</span> <span class="n">s</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">"0000000"</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="s">'1'</span><span class="p">:</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>
        
        <span class="k">if</span> <span class="n">check_status</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
            <span class="n">dfs</span><span class="p">(</span><span class="s">"1"</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="s">"1"</span><span class="p">)</span>
            <span class="n">dfs</span><span class="p">(</span><span class="s">"0"</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="s">"0"</span><span class="p">)</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="n">hint</span> <span class="o">=</span> <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">hint</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">hint</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">hint</span>

        <span class="k">if</span> <span class="n">check_status</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
            <span class="n">dfs</span><span class="p">(</span><span class="s">"1"</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="s">"1"</span><span class="p">)</span>
            <span class="n">dfs</span><span class="p">(</span><span class="s">"0"</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="s">"0"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a1</span><span class="p">:</span>
            <span class="n">egg</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">16</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">a2</span><span class="p">:</span>
            <span class="n">bacon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">16</span><span class="p">].</span><span class="n">pop</span><span class="p">()</span>

<span class="n">dfs</span><span class="p">(</span><span class="s">"1"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>
</code></pre></div></div>
<p>🎉🎉 And behold, we have obtained our output! 🎉🎉</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1100001110110111000011110100110010111101011110010111001110000111010100100011011110111101111101000110100111100111011111110001011001011101100110111111011101100111111001110111111101001110111011100111100011100100110010110111111101101110100111010111000111111101
</code></pre></div></div>
<p>⚠️💔 One final unpleasant aspect to note is that the challenge seems to disregard the zeroes on the left of a byte. Additionally, while all letters are represented by 7 bits, the digits occupy only 6 bits. This introduces a guessing game when parsing the input, as we need to determine the correct positions for the digits. 😕🔢</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="s">"1100001110110111000011110100110010111101011110010111001110000111010100100011011110111101111101000110100111100111011111110001011001011101100110111111011101100111111001
   ...: 110111111101001110111011100111100011100100110010110111111101101110100111010111000111111101"</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">tryit</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
   <span class="p">...:</span>     <span class="n">s</span> <span class="o">=</span> <span class="s">""</span>
   <span class="p">...:</span>     <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="p">...:</span>     <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="p">...:</span>     <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
   <span class="p">...:</span>         <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
   <span class="p">...:</span>             <span class="n">s</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
   <span class="p">...:</span>             <span class="n">i</span> <span class="o">+=</span> <span class="mi">6</span>
   <span class="p">...:</span>         <span class="k">else</span><span class="p">:</span>
   <span class="p">...:</span>             <span class="n">s</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
   <span class="p">...:</span>             <span class="n">i</span> <span class="o">+=</span> <span class="mi">7</span>
   <span class="p">...:</span>         <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
   <span class="p">...:</span>     <span class="k">return</span> <span class="n">s</span>
   <span class="p">...:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">):</span>
   <span class="p">...:</span>     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">):</span>
   <span class="p">...:</span>         <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
   <span class="p">...:</span>         <span class="n">s</span> <span class="o">=</span> <span class="n">tryit</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
   <span class="p">...:</span>         <span class="k">if</span> <span class="n">s</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'}'</span><span class="p">):</span>
   <span class="p">...:</span>             <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
   <span class="p">...:</span>
</code></pre></div></div>
<p>🖨️🔍✨ During the process, it seems that multiple possibilities were printed, but only one of them made logical sense. 🤔📄💡</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>amateursCTF{7his_belongs_ins1de_mi5c}
</code></pre></div></div>
<p>🎉🎉 GG 😉🎮🏆</p>

<h1 id="angstrom-ctf-2023">Angstrom CTF 2023</h1>

<h2 id="obligatory">Obligatory</h2>
<h3 id="tldr">TLDR</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">__builtins__</span><span class="p">:</span><span class="o">=</span><span class="nb">__import__</span><span class="p">(</span><span class="s">'code'</span><span class="p">))</span><span class="o">==</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="n">interact</span><span class="p">())()</span>
</code></pre></div></div>
<h3 id="the-challenge">The Challenge</h3>
<blockquote>
  <p>“angstrom needs a pyjail” - kmh11</p>
</blockquote>

<p>We’re given a Python file and an address where the Python program is running. Our goal is to get a shell.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/local/bin/python
</span><span class="n">cod</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"sned cod: "</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"q(jw=_alsynxodtg)feum'zk:hivbcpr"</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cod</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"bad cod"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">cod</span><span class="p">,</span> <span class="p">{</span><span class="s">"__builtins__"</span><span class="p">:</span> <span class="p">{</span><span class="s">"__import__"</span><span class="p">:</span> <span class="nb">__import__</span><span class="p">}}))</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"oop"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div></div>
<p>At the beginning we read the input, then we check the input against some letters and if all letters in the input are allowed then we pass our string to an eval. The biggest caveat of this challenge is the lack a dot, so we can’t do it in the usual method of calling methods on an import and the only function given to our <code class="language-plaintext highlighter-rouge">eval</code> through globals is <code class="language-plaintext highlighter-rouge">__import__</code>. The eval function also takes an <code class="language-plaintext highlighter-rouge">locals</code> argument which we didn’t overwrote so we can check if maybe there’s something useful. I’ll do this by adding a simple <code class="language-plaintext highlighter-rouge">print(locals())</code> at the beginning.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  Downloads head jail.py
#!/usr/local/bin/python
print(locals())
cod = input("sned cod: ")

if any(x not in "q(jw=_alsynxodtg)feum'zk:hivbcpr" for x in cod):
    print("bad cod")
else:
    try:
        print(eval(cod, {"__builtins__": {"__import__": __import__}}))
    except Exception as e:
➜  Downloads python jail.py
{'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': &lt;_frozen_importlib_external.SourceFileLoader object at 0x7f8ce1a1d450&gt;, '__spec__': None, '__annotations__': {}, '__builtins__': &lt;module 'builtins' (built-in)&gt;, '__file__': '/home/tabun-dareka/Downloads/jail.py', '__cached__': None}
</code></pre></div></div>
<p>Even though there’s nothing useful there, we can see the <code class="language-plaintext highlighter-rouge">__builtins__</code> dunder variable there, and that’s how I got this idea of overwriting it. So now let’s explain why this solution works step by step.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">__builtins__</span><span class="p">:</span><span class="o">=</span><span class="nb">__import__</span><span class="p">(</span><span class="s">'code'</span><span class="p">))</span><span class="o">==</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="n">interact</span><span class="p">())()</span>
</code></pre></div></div>
<h3 id="why-">Why <code class="language-plaintext highlighter-rouge">:=</code>?</h3>
<p>We need to overwrite the <code class="language-plaintext highlighter-rouge">__builtins__</code> variable but the eval function in Python takes as an argument an expression not a statement. In python the <code class="language-plaintext highlighter-rouge">=</code> operator defines a statement which makes it impossible to use as a part of an expression, which btw sometimes makes some logic annoying to express. To fix it Python developers decided to add the walrus operator <code class="language-plaintext highlighter-rouge">:=</code> which serves the same purpose as normal equal operator but can be used in expressions instead.
If you’re not accustomed to thinking in terms of programming language’s gramma this might be confusing to you, so there are some examples to make the difference between an expression and statement clearer:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is an if statement
</span><span class="k">if</span> <span class="n">SomeExpressionThere</span><span class="p">:</span> <span class="k">pass</span>

<span class="c1"># This is an example expression
</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">4</span>
</code></pre></div></div>

<p>Does the equal sign needs to be a statement? No, and there are more expression based languages like Rust where equal sign defines an expression, not a statement. But Python isn’t one of them.</p>

<h3 id="whats-__builtins__">What’s <code class="language-plaintext highlighter-rouge">__builtins__</code>?</h3>
<p>Python is full of magic variables with double underscores, also called dunders, that define how the language behaves and this variable is one of them. Usually inside of this variable we can find all the python built-in functions like <code class="language-plaintext highlighter-rouge">print</code>, <code class="language-plaintext highlighter-rouge">eval</code>, <code class="language-plaintext highlighter-rouge">input</code>, etc. that are exposed to us in the global namespace even though we didn’t import anything. We can overwrite this variable so we have access to different functions in our payload like if they were built-ins. I want to import <code class="language-plaintext highlighter-rouge">code</code>, so I can get a shell with <code class="language-plaintext highlighter-rouge">code.interact()</code>.</p>

<h3 id="why-do-we-need-a-lambda">Why Do We Need A Lambda?</h3>
<p>If we try the example solution without a lambda it doesn’t work which might be confusing. Through some experimentation we can see that Python still uses the old <code class="language-plaintext highlighter-rouge">__builtins__</code> from before the overwrite within the context of our expression. So we somehow need to get a new context without leaving the expression. This is where out lambda will be useful.</p>

<h3 id="getting-the-flag">Getting The Flag</h3>
<p>After we get the shell, getting the flag is trivial.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'ls'</span><span class="p">)</span>
<span class="n">flag</span><span class="o">-</span><span class="n">a0d6b8185c3677d985e6fb346b3f88b1</span><span class="p">.</span><span class="n">txt</span>
<span class="n">run</span>
<span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'cat flag-a0d6b8185c3677d985e6fb346b3f88b1.txt'</span><span class="p">)</span>
<span class="n">actf</span><span class="p">{</span><span class="n">c0uln7_g3t_1t_7o_w0rk_0n_python39_s4dge</span><span class="p">}</span>
</code></pre></div></div>

<h2 id="ti">TI</h2>
<h3 id="the-challenge-1">The Challenge</h3>
<blockquote>
  <p>My friend sent me this town simulator. I can’t seem to beat it. Can you help me?</p>
</blockquote>

<p>According to <code class="language-plaintext highlighter-rouge">file</code> we’re given a TI-83+ calculator program.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  angstrom file ~/Downloads/TOWN.8xp
/home/tabun-dareka/Downloads/TOWN.8xp: TI-83+ Graphing Calculator (assembly program)
</code></pre></div></div>
<p>First before trying anything I was silently hoping that maybe the flag is encoded by a byte xor but I checked the file for that in the REPL and nothing appeared, so that was an failed try. So we will be defaulting to running an emulator and continue with that.</p>

<h3 id="the-setup">The Setup</h3>
<p>I wasn’t the first to look at this challenge in my team and my teammate Sn0w helped me with the initial setup, so I don’t really know anything specific about it, I will just take you through the steps to get it running.</p>

<p>This is the emulator we used: https://github.com/CE-Programming/CEmu
This is the ROM we used (top-most one): https://tiroms.weebly.com</p>

<p>To send all the things into the calculator emulator go to the <code class="language-plaintext highlighter-rouge">Variables</code> tab and do it there.</p>

<p><img src="/files/screenshot_20230427_014241.png" alt="screenshot_20230427_014241.png" /></p>

<p>After that go to the <code class="language-plaintext highlighter-rouge">Keypad</code> tab and press <code class="language-plaintext highlighter-rouge">prgm</code> button to load the files.</p>

<p><img src="/files/screenshot_20230427_002409.png" alt="screenshot_20230427_002409.png" /></p>

<p>After that we get a menu from which we can select the town executable.</p>

<p><img src="/files/screenshot_20230427_002631.png" alt="screenshot_20230427_002631.png" /></p>

<p>You can type letters and do everything in the calculator through the <code class="language-plaintext highlighter-rouge">Keypad</code> tab.</p>

<h3 id="exploring-the-emulator">Exploring The Emulator</h3>
<p>Before doing anything it’s worth to see what’s there in the emulator. It turns out the emulator has a quite powerful debugging tools which we will be abusing. Memory inspection, disassembly, breakpoints, watchpoints, even saving and restoring the whole state. After playing a little bit with moving all the windows around etc., this is how my setup looked like (I changed from dark theme to light theme in KDE cuz the colors in the emulator like the dark blue in the disassembly looked horrible with a dark theme):</p>

<p><img src="/files/screenshot_20230427_003113.png" alt="screenshot_20230427_003113.png" /></p>

<h3 id="first-screen">First Screen</h3>
<p><img src="/files/7.png" alt="7.png" /></p>

<p>At the beginning the program asks us for a name. This is basically a simple crackme with a twist that it’s from an calculator emulator. In the <code class="language-plaintext highlighter-rouge">Memory</code> tab we can search for the string we entered and put a watchpoint there, so it triggers a breakpoint while the password checking code is reading it. You can add the watchpoint by rightclicking the selected byte and choosing the right option.</p>

<p><img src="/files/screenshot_20230427_003953.png" alt="screenshot_20230427_003953.png" /></p>

<p>And surely as expected it triggers a watchpoint while comparing two strings.</p>

<p><img src="/files/screenshot_20230427_004744.png" alt="screenshot_20230427_004744.png" /></p>

<p>To be honest I haven’t even read the assembly there but we can see that we have two pointers stored in the registers in the <code class="language-plaintext highlighter-rouge">CPU Status</code> tab. DE points to our string and HL points to some other string <code class="language-plaintext highlighter-rouge">CE C RELEASE</code>. Now when we try to type this string into the input it takes us to a second screen.</p>

<h3 id="second-screen">Second Screen</h3>

<p><img src="/files/screenshot_20230427_005313.png" alt="screenshot_20230427_005313.png" /></p>

<p>I won’t show you what each npc says cuz pasting those screenshots into a markdown file gets pretty annoying, but every one of them gives you a hint related to the final password check during option one. Basically:</p>
<ol>
  <li>“Your pass to get in will lead you further”, so the final password is somehow related to the first one.</li>
  <li>“Index 5”, so we’re starting from the fifth index, so probably the password is related to the string “RELEASE”</li>
  <li>“Alternates to end”, ???, noone in our team guessed what this hint is trying to say.</li>
  <li>Takes an input and mirrors it, so for example for “123” we’re returned “123321”</li>
</ol>

<p>So now during the second password we use the same trick with the watchpoints from the first password check. Now we’re taken to the second password checker but this time there’s no second string in the registers. By stepping a little we can see how the values in the registers change. Again I havent read almost any assembly cuz I’m too lazy for it.</p>

<p><img src="/files/screenshot_20230427_010344.png" alt="screenshot_20230427_010344.png" /></p>

<p>We can observe our letter being loaded into the <code class="language-plaintext highlighter-rouge">a</code> register, then some other letter being loaded into the <code class="language-plaintext highlighter-rouge">l</code> register, and then they are compared. So we can make an obvious guess that the password is loaded into the l register. We can put a breakpoint at</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D1AD9C     BD            cp a,l
</code></pre></div></div>
<p>and read the password letter by letter. Boom! We got the password: “RLAE”.
After putting it in we get a flag but it appears corrupted. :/</p>

<p><img src="/files/aaaaa.png" alt="aaaaa.png" /></p>

<p>Now I made just an educated guess based on the hints and instead typed “RLAEEALR” and we got the full flag: <code class="language-plaintext highlighter-rouge">actf{e4sy_80_4ss3embIy7}</code>.</p>


  </div><a class="u-url" href="/ctf/rev/emulator/pyjail/2024/01/05/Archiving-old-writeups.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">poni&#39;s blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">poni&#39;s blog</li><li><a class="u-email" href="mailto:poniponiponiponiponiponiponiponiponiponi@protonmail.com">poniponiponiponiponiponiponiponiponiponi@protonmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/poniponiponiponiponiponiponiponiponi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">poniponiponiponiponiponiponiponiponi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>My tech blog where I write about things I find interesting. Mostly low level programming, linux and ctf competitions.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
